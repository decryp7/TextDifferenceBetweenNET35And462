kind: pipeline
type: exec
name: default

platform:
  os: windows

steps:
- name: restore nuget packages
  commands:
    - c:\nuget\nuget.exe restore FormattedTextTest.sln
- name: compile
  commands:
    - Invoke-MsBuild -Path FormattedTextTest.sln -ShowBuildOutputInCurrentWindow -PassThru
- name: upload artifacts
  environment:
    username:
      from_secret: username
    password:
      from_secret: password
  commands:
    - $base64AuthInfo = [Convert]::ToBase64String([Text.Encoding]::ASCII.GetBytes(("{0}:{1}" -f $username,$password)))
    - $base64AuthInfo
    - Invoke-RestMethod -Headers @{Authorization=("Basic {0}" -f $base64AuthInfo)} --upload-file bin\Debug\FormattedTextTestClient.exe https://repository.decryptology.net/repository/Artifacts/FormattedTextTestClient.exe

